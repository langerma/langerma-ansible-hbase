---
- name: put hbase-site.xml
  template:
    src: hbase-site.xml
    dest: "{{ hbase_conf_dir }}/hbase-site.xml"
    owner: "{{ hbase_user }}"
    group: "{{ hbase_group }}"
    mode: 0644
    backup: no
  register: hbase_site_xml
  notify:
    - Restart hbase-master
    - Restart hbase-regionserver

- name: put hbase-policy.xml
  template:
    src: hbase-policy.xml
    dest: "{{ hbase_conf_dir }}/hbase-policy.xml"
    owner: "{{ hbase_user }}"
    group: "{{ hbase_group }}"
    mode: 0644
    backup: no
  notify:
    - Restart hbase-master
    - Restart hbase-regionserver

- name: put hbase-env.sh
  template:
    src: hbase-env.sh
    dest: "{{ hbase_conf_dir }}/hbase-env.sh"
    owner: "{{ hbase_user }}"
    group: "{{ hbase_group }}"
    mode: 0755
    backup: no
  notify:
    - Restart hbase-master
    - Restart hbase-regionserver

- name: put log4j.properties
  template:
    src: log4j.properties
    dest: "{{ hbase_conf_dir }}/log4j.properties"
    owner: "{{ hbase_user }}"
    group: "{{ hbase_group }}"
    mode: 0644
    backup: no

- name: put hadoop-metrics2-hbase.properties
  template:
    src: hadoop-metrics2-hbase.properties
    dest: "{{ hbase_conf_dir }}/hadoop-metrics2-hbase.properties"
    owner: "{{ hbase_user }}"
    group: "{{ hbase_group }}"
    mode: 0644
    backup: no

- name: put jmxremote.access
  template:
    src: jmxremote.access
    dest: "{{ hbase_conf_dir }}/jmxremote.access"
    owner: "{{ hbase_user }}"
    group: "{{ hbase_group }}"
    mode: 0644
    backup: no

- name: put jmxremote.passwd
  template:
    src: jmxremote.passwd
    dest: "{{ hbase_conf_dir }}/jmxremote.passwd"
    owner: "{{ hbase_user }}"
    group: "{{ hbase_group }}"
    mode: 0644
    backup: no

- name: create hdfs-site.xml
  file:
    state: link
    src: "{{ hdfs_conf_dir }}/hdfs-site.xml"
    dest: "{{ hbase_conf_dir }}/hdfs-site.xml"

- name: create core-site.xml
  file:
    state: link
    src: "{{ hdfs_conf_dir }}/core-site.xml"
    dest: "{{ hbase_conf_dir }}/core-site.xml"
